<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SmoovSign - חתימה דיגיטלית</title>
    <meta name="description" content="SmoovSign - מערכת חתימה דיגיטלית לניהול מסמכים">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SmoovSign">
    <link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%232563eb'/%3E%3Cstop offset='1' stop-color='%234f46e5'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23g)'/%3E%3Cpath d='M58 16H36a8 8 0 00-8 8v52a8 8 0 008 8h28a8 8 0 008-8V42l-14-26z' fill='rgba(255,255,255,0.2)' stroke='white' stroke-width='3.5'/%3E%3Cpolyline points='58 16 58 42 72 42' fill='none' stroke='white' stroke-width='3.5'/%3E%3Cpath d='M36 60c8-12 14 4 18-4s8-14 12-4' stroke='white' stroke-width='5' stroke-linecap='round' fill='none'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%232563eb'/%3E%3Cstop offset='1' stop-color='%234f46e5'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='180' height='180' rx='38' fill='url(%23g)'/%3E%3Cpath d='M105 30H66a14 14 0 00-14 14v92a14 14 0 0014 14h48a14 14 0 0014-14V76l-23-46z' fill='rgba(255,255,255,0.2)' stroke='white' stroke-width='6'/%3E%3Cpolyline points='105 30 105 76 128 76' fill='none' stroke='white' stroke-width='6'/%3E%3Cpath d='M66 110c14-22 24 8 32-6s14-24 20-6' stroke='white' stroke-width='8' stroke-linecap='round' fill='none'/%3E%3C/svg%3E">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- Firebase SDK (compat mode - no build tools needed) -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.2/jspdf.umd.min.js"></script>
    <!-- EmailJS SDK for email notifications -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="email-config.js"></script>
</head>
<body>
    <!-- Top Navigation -->
    <header class="topbar" id="appTopbar">
        <div class="topbar-right">
            <div class="logo" onclick="switchView('home')" style="cursor:pointer;">
                <svg class="logo-svg" width="32" height="32" viewBox="0 0 100 100">
                    <defs><linearGradient id="lg" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#2563eb"/><stop offset="1" stop-color="#4f46e5"/></linearGradient></defs>
                    <rect width="100" height="100" rx="20" fill="url(#lg)"/>
                    <path d="M58 16H36a8 8 0 00-8 8v52a8 8 0 008 8h28a8 8 0 008-8V42l-14-26z" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="3.5"/>
                    <polyline points="58 16 58 42 72 42" fill="none" stroke="white" stroke-width="3.5"/>
                    <path d="M36 60c8-12 14 4 18-4s8-14 12-4" stroke="white" stroke-width="5" stroke-linecap="round" fill="none"/>
                </svg>
                <span class="logo-text">SmoovSign</span>
            </div>
        </div>
        <div class="topbar-left">
            <!-- User Menu -->
            <div class="user-menu" id="userMenu" style="display:none;">
                <button class="user-avatar-btn" onclick="toggleUserDropdown()">
                    <img id="userAvatar" src="" alt="user" class="user-avatar">
                    <span id="userNameTopbar" style="font-size:0.85em;font-weight:600;margin-right:6px;"></span>
                </button>
                <div class="user-dropdown hidden" id="userDropdown">
                    <div class="user-dropdown-info">
                        <strong id="userName"></strong>
                        <small id="userEmail"></small>
                    </div>
                    <hr>
                    <button class="user-dropdown-item" onclick="signOut()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        התנתק
                    </button>
                </div>
            </div>
            <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleMobileMenu()">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
            </button>
        </div>
    </header>

    <!-- App Layout: Sidebar + Main -->
    <div class="app-layout" id="appLayout">
        <aside class="app-sidebar" id="appSidebar"></aside>
        <main id="mainContent"></main>
    </div>
    <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="closeMobileMenu()"></div>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-card">
            <div class="login-logo-wrap">
                <svg width="44" height="44" viewBox="0 0 24 24" fill="none">
                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z" fill="rgba(255,255,255,0.2)" stroke="white" stroke-width="1.5"/>
                    <polyline points="14 2 14 8 20 8" fill="none" stroke="white" stroke-width="1.5"/>
                    <path d="M8 15c2-3 4 1 5-1s2-4 3-1" stroke="white" stroke-width="2" stroke-linecap="round" fill="none"/>
                </svg>
            </div>
            <h1>SmoovSign</h1>
            <p>חתימה דיגיטלית חכמה</p>
            <button class="google-signin-btn" onclick="signInWithGoogle()">
                <svg width="20" height="20" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
                התחבר עם Google
            </button>
            <div class="login-footer">
                <small>בהתחברות אתה מסכים ל<a href="#">תנאי השימוש</a> ו<a href="#">מדיניות הפרטיות</a></small>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast hidden"></div>

    <script src="app.js"></script>
</body>
</html>
